{"filter":false,"title":"server.js","tooltip":"/server.js","undoManager":{"mark":51,"position":51,"stack":[[{"start":{"row":0,"column":0},"end":{"row":5,"column":0},"action":"remove","lines":["//","// # SimpleServer","//","// A simple chat server using Socket.IO, Express, and Async.","//",""],"id":2,"ignore":true},{"start":{"row":3,"column":0},"end":{"row":4,"column":31},"action":"remove","lines":["","//var async = require('async');"]},{"start":{"row":7,"column":2},"end":{"row":11,"column":99},"action":"remove","lines":["","// ## SimpleServer `SimpleServer(obj)`","//","// Creates a new instance of SimpleServer with the following options:","//  * `port` - The HTTP port to listen on. If `process.env.PORT` is set, _it overrides this value_."]}],[{"start":{"row":7,"column":0},"end":{"row":8,"column":2},"action":"remove","lines":["//","//"],"id":3,"ignore":true}],[{"start":{"row":10,"column":0},"end":{"row":70,"column":2},"action":"remove","lines":["/*var io = socketio.listen(server);","","router.use(express.static(path.resolve(__dirname, 'client')));","var messages = [];","var sockets = [];","","io.on('connection', function (socket) {","    messages.forEach(function (data) {","      socket.emit('message', data);","    });","","    sockets.push(socket);","","    socket.on('disconnect', function () {","      sockets.splice(sockets.indexOf(socket), 1);","      updateRoster();","    });","","    socket.on('message', function (msg) {","      var text = String(msg || '');","","      if (!text)","        return;","","      socket.get('name', function (err, name) {","        var data = {","          name: name,","          text: text","        };","","        broadcast('message', data);","        messages.push(data);","      });","    });","","    socket.on('identify', function (name) {","      socket.set('name', String(name || 'Anonymous'), function (err) {","        updateRoster();","      });","    });","  });","","","function updateRoster() {","  async.map(","    sockets,","    function (socket, callback) {","      socket.get('name', callback);","    },","    function (err, names) {","      broadcast('roster', names);","    }","  );","}","","function broadcast(event, data) {","  sockets.forEach(function (socket) {","    socket.emit(event, data);","  });","}","*/"],"id":4,"ignore":true}],[{"start":{"row":14,"column":15},"end":{"row":14,"column":39},"action":"remove","lines":["Chat server listening at"],"id":5,"ignore":true},{"start":{"row":14,"column":15},"end":{"row":14,"column":19},"action":"insert","lines":["List"]}],[{"start":{"row":14,"column":19},"end":{"row":14,"column":24},"action":"insert","lines":["ening"],"id":6,"ignore":true}],[{"start":{"row":14,"column":24},"end":{"row":14,"column":25},"action":"insert","lines":[" "],"id":7,"ignore":true}],[{"start":{"row":14,"column":25},"end":{"row":14,"column":27},"action":"insert","lines":["at"],"id":8,"ignore":true}],[{"start":{"row":14,"column":30},"end":{"row":14,"column":34},"action":"remove","lines":["addr"],"id":9,"ignore":true},{"start":{"row":14,"column":30},"end":{"row":14,"column":31},"action":"insert","lines":["{"]}],[{"start":{"row":14,"column":30},"end":{"row":14,"column":31},"action":"remove","lines":["{"],"id":10,"ignore":true},{"start":{"row":14,"column":30},"end":{"row":14,"column":34},"action":"insert","lines":["addr"]}],[{"start":{"row":14,"column":30},"end":{"row":14,"column":31},"action":"insert","lines":["\""],"id":11,"ignore":true}],[{"start":{"row":14,"column":31},"end":{"row":14,"column":32},"action":"insert","lines":["$"],"id":12,"ignore":true}],[{"start":{"row":14,"column":44},"end":{"row":14,"column":53},"action":"remove","lines":[" + \":\" + "],"id":13,"ignore":true},{"start":{"row":14,"column":44},"end":{"row":14,"column":45},"action":"insert","lines":[" "]}],[{"start":{"row":14,"column":45},"end":{"row":14,"column":46},"action":"insert","lines":["\""],"id":14,"ignore":true}],[{"start":{"row":14,"column":45},"end":{"row":14,"column":46},"action":"remove","lines":["\""],"id":15,"ignore":true},{"start":{"row":14,"column":45},"end":{"row":14,"column":46},"action":"insert","lines":[":"]}],[{"start":{"row":14,"column":46},"end":{"row":14,"column":47},"action":"insert","lines":[" "],"id":16,"ignore":true}],[{"start":{"row":14,"column":47},"end":{"row":14,"column":48},"action":"insert","lines":["$"],"id":17,"ignore":true}],[{"start":{"row":14,"column":57},"end":{"row":14,"column":58},"action":"insert","lines":["}"],"id":18,"ignore":true}],[{"start":{"row":14,"column":58},"end":{"row":14,"column":59},"action":"insert","lines":["\""],"id":19,"ignore":true}],[{"start":{"row":14,"column":58},"end":{"row":14,"column":59},"action":"remove","lines":["\""],"id":20,"ignore":true},{"start":{"row":14,"column":58},"end":{"row":14,"column":59},"action":"insert","lines":["`"]}],[{"start":{"row":14,"column":30},"end":{"row":14,"column":31},"action":"remove","lines":["\""],"id":21,"ignore":true},{"start":{"row":14,"column":30},"end":{"row":14,"column":31},"action":"insert","lines":["`"]}],[{"start":{"row":14,"column":57},"end":{"row":14,"column":58},"action":"remove","lines":["}"],"id":22,"ignore":true}],[{"start":{"row":14,"column":27},"end":{"row":14,"column":29},"action":"remove","lines":["\","],"id":23,"ignore":true}],[{"start":{"row":14,"column":27},"end":{"row":14,"column":29},"action":"remove","lines":[" `"],"id":24,"ignore":true}],[{"start":{"row":14,"column":27},"end":{"row":14,"column":28},"action":"insert","lines":[" "],"id":25,"ignore":true}],[{"start":{"row":14,"column":14},"end":{"row":14,"column":15},"action":"remove","lines":["\""],"id":26,"ignore":true},{"start":{"row":14,"column":14},"end":{"row":14,"column":15},"action":"insert","lines":["`"]}],[{"start":{"row":14,"column":29},"end":{"row":14,"column":30},"action":"insert","lines":["{"],"id":27,"ignore":true}],[{"start":{"row":14,"column":42},"end":{"row":14,"column":43},"action":"insert","lines":["}"],"id":28,"ignore":true}],[{"start":{"row":14,"column":47},"end":{"row":14,"column":48},"action":"insert","lines":["}"],"id":29,"ignore":true}],[{"start":{"row":14,"column":57},"end":{"row":14,"column":58},"action":"insert","lines":["}"],"id":30,"ignore":true}],[{"start":{"row":14,"column":47},"end":{"row":14,"column":48},"action":"remove","lines":["}"],"id":31,"ignore":true}],[{"start":{"row":14,"column":47},"end":{"row":14,"column":48},"action":"insert","lines":["{"],"id":32,"ignore":true}],[{"start":{"row":15,"column":3},"end":{"row":17,"column":52},"action":"insert","lines":["","","app.get('/', (req, res) => res.send('Hello World!'))"],"id":33,"ignore":true}],[{"start":{"row":17,"column":0},"end":{"row":17,"column":52},"action":"remove","lines":["app.get('/', (req, res) => res.send('Hello World!'))"],"id":34,"ignore":true}],[{"start":{"row":17,"column":0},"end":{"row":17,"column":52},"action":"insert","lines":["app.get('/', (req, res) => res.send('Hello World!'))"],"id":35,"ignore":true}],[{"start":{"row":17,"column":0},"end":{"row":17,"column":3},"action":"remove","lines":["app"],"id":36,"ignore":true},{"start":{"row":17,"column":0},"end":{"row":17,"column":7},"action":"insert","lines":["express"]}],[{"start":{"row":17,"column":0},"end":{"row":17,"column":7},"action":"remove","lines":["express"],"id":37,"ignore":true},{"start":{"row":17,"column":0},"end":{"row":17,"column":6},"action":"insert","lines":["router"]}],[{"start":{"row":18,"column":0},"end":{"row":18,"column":44},"action":"insert","lines":["app.use('/static', express.static('public'))"],"id":38,"ignore":true}],[{"start":{"row":18,"column":7},"end":{"row":18,"column":44},"action":"remove","lines":["('/static', express.static('public'))"],"id":39,"ignore":true},{"start":{"row":18,"column":7},"end":{"row":18,"column":13},"action":"insert","lines":["router"]}],[{"start":{"row":18,"column":7},"end":{"row":18,"column":13},"action":"remove","lines":["router"],"id":40,"ignore":true},{"start":{"row":18,"column":7},"end":{"row":18,"column":44},"action":"insert","lines":["('/static', express.static('public'))"]}],[{"start":{"row":18,"column":0},"end":{"row":18,"column":3},"action":"remove","lines":["app"],"id":41,"ignore":true},{"start":{"row":18,"column":0},"end":{"row":18,"column":6},"action":"insert","lines":["router"]}],[{"start":{"row":18,"column":13},"end":{"row":18,"column":19},"action":"remove","lines":["static"],"id":42,"ignore":true},{"start":{"row":18,"column":13},"end":{"row":18,"column":17},"action":"insert","lines":["clie"]}],[{"start":{"row":18,"column":17},"end":{"row":18,"column":19},"action":"insert","lines":["nt"],"id":43,"ignore":true}],[{"start":{"row":18,"column":47},"end":{"row":19,"column":47},"action":"insert","lines":["","app.use(express.static(__dirname + '/public'));"],"id":59,"ignore":true}],[{"start":{"row":19,"column":0},"end":{"row":19,"column":47},"action":"remove","lines":["app.use(express.static(__dirname + '/public'));"],"id":62,"ignore":true},{"start":{"row":19,"column":0},"end":{"row":19,"column":47},"action":"insert","lines":["app.use(express.static(__dirname + '/public'));"]}],[{"start":{"row":19,"column":0},"end":{"row":19,"column":47},"action":"remove","lines":["app.use(express.static(__dirname + '/public'));"],"id":63,"ignore":true}],[{"start":{"row":19,"column":0},"end":{"row":19,"column":47},"action":"insert","lines":["app.use(express.static(__dirname + '/public'));"],"id":64,"ignore":true}],[{"start":{"row":19,"column":0},"end":{"row":19,"column":3},"action":"remove","lines":["app"],"id":65,"ignore":true},{"start":{"row":19,"column":0},"end":{"row":19,"column":4},"action":"insert","lines":["rout"]}],[{"start":{"row":19,"column":4},"end":{"row":19,"column":6},"action":"insert","lines":["er"],"id":66,"ignore":true}],[{"start":{"row":19,"column":40},"end":{"row":19,"column":46},"action":"remove","lines":["public"],"id":67,"ignore":true},{"start":{"row":19,"column":40},"end":{"row":19,"column":45},"action":"insert","lines":["clien"]}],[{"start":{"row":19,"column":45},"end":{"row":19,"column":46},"action":"insert","lines":["t"],"id":68,"ignore":true}],[{"start":{"row":17,"column":55},"end":{"row":18,"column":47},"action":"remove","lines":["","router.use('/client', express.static('public'))"],"id":69,"ignore":true}],[{"start":{"row":17,"column":0},"end":{"row":17,"column":2},"action":"insert","lines":["//"],"id":70,"ignore":true}],[{"start":{"row":20,"column":0},"end":{"row":20,"column":50},"action":"insert","lines":["router.use(express.static(__dirname + '/client'));"],"id":78}],[{"start":{"row":19,"column":0},"end":{"row":20,"column":0},"action":"insert","lines":["",""],"id":77}],[{"start":{"row":18,"column":55},"end":{"row":19,"column":0},"action":"insert","lines":["",""],"id":76}],[{"start":{"row":17,"column":0},"end":{"row":17,"column":50},"action":"remove","lines":["router.use(express.static(__dirname + '/client'));"],"id":74}],[{"start":{"row":16,"column":0},"end":{"row":17,"column":50},"action":"insert","lines":["","router.use(express.static(__dirname + '/client'));"],"id":73}],[{"start":{"row":17,"column":55},"end":{"row":18,"column":50},"action":"remove","lines":["","router.use(express.static(__dirname + '/client'));"],"id":72}],[{"start":{"row":17,"column":0},"end":{"row":17,"column":2},"action":"remove","lines":["//"],"id":71}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":18,"column":50},"end":{"row":18,"column":50},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1538862904683,"hash":"f49dd595f767eb0496b86e5d359cbebfad45160d"}